# 본인확인-API인증 타입별 요청정보 (JSON) 

## 휴대폰본인본인 (SMS / PASS)

### SMS

| 이름                     | 타입     | 설명                                                                                                                                            | 필수  |
| ---------------------- | ------ | --------------------------------------------------------------------------------------------------------------------------------------------- | --- |
| serviceType            | String | 이용상품 코드<br>“telcoAuth” : 휴대폰본인확인 SMS/PASS 인증 서비스                                                                                              | O   |
| providerId             | String | 서비스 제공 이동통신사 및 서비스<br>- SKT / SKTMVNO<br>- KT / KTMVNO<br>- LGU / LGUMVNO                                                                     | O   |
| reqAuthType            | String | 본인확인 인증Type 코드  (인증번호 전송 타입 또는 인증방법)<br>- SMS                                                                                                 | O   |
| usageCode              | String | 서비스 이용 코드<br>- 01001 : 회원가입<br>- 01002 : 정보변경  <br>- 01003 : ID찾기<br>- 01004 : 비밀번호찾기<br>- 01005 : 본인확인용<br>- 01007 : 상품구매/결제<br>- 01999 : 기타 | O   |
| username               | String | 사용자명                                                                                                                                          | O   |
| userPhone              | String | 사용자 핸드폰 번호                                                                                                                                    | O   |
| userBirthday           | String | 사용자 생년월일 (8자리) YYYYMMDD                                                                                                                       | O   |
| userRegistSingleNumber | String | 사용자 주민번호 뒤 자리 첫번째 숫자  <br>해당 파라미터가 사용되는 경우 userGender와 userNation값은 무시됩니다.                                                                    |     |
| userGender             | String | 사용자 성별<br>- 1 : 남자<br>- 2 : 여자                                                                                                                | O   |
| userNation             | String | 사용자 내외국인 정보<br>- 0 : 내국인<br>- 1 : 외국인                                                                                                         | O   |
| sendMsg                | String | SMS 전송 시 사용할 80Byte 이내 메시지.  <br>- NULL 또는 속성이 없을 경우 기본메시지 전송                                                                                 |     |
| replyNumber            | String | SMS 전송 시 사용할 송신번호 입력- NULL 또는 속성이 없을 경우 서비스에 등록된 이용기관 전화번호 또는 휴대폰본인확인 콜센터 번호 입력                                                               |     |
| retTransferType        | String | 요청 대상의 결과 전송 타입<br>- 개인정보 서버 수신 모드 : MOKResult                                                                                                | O   |
#### JSON : MOKAuthInfo(인증요청 정보)

```json
{
	"serviceType": "telcoAuth",
	"providerId": ${providerId},
	"reqAuthType": "SMS",
	"usageCode": ${usageCode},
	"userName": ${userName},
	"userPhone": ${userPhone},
	"userBirthday": ${userBirthday},
	"userGender": ${userGender},
	"userNation": ${userNation},
	"retTransferType": "MOKResult"
}
```

> 위 JSON 데이터는 실제 사용 시 문자열(JSON string) 형태로 변환하여 사용해야 합니다.

---
### PASS

| 이름              | 타입     | 설명                                                                                                                                            | 필수  |
| --------------- | ------ | --------------------------------------------------------------------------------------------------------------------------------------------- | --- |
| serviceType     | String | 이용상품 코드<br>“telcoAuth” : 휴대폰본인확인 SMS/PASS 인증 서비스                                                                                              | O   |
| providerId      | String | 서비스 제공 이동통신사 및 서비스<br>- SKT / SKTMVNO<br>- KT / KTMVNO<br>- LGU / LGUMVNO                                                                     | O   |
| reqAuthType     | String | 본인확인 인증Type 코드, 인증번호 전송 타입 또는 인증방법<br>- PASS                                                                                                  | O   |
| usageCode       | String | 서비스 이용 코드<br>- 01001 : 회원가입<br>- 01002 : 정보변경  <br>- 01003 : ID찾기<br>- 01004 : 비밀번호찾기<br>- 01005 : 본인확인용<br>- 01007 : 상품구매/결제<br>- 01999 : 기타 | O   |
| Username        | String | 사용자명                                                                                                                                          | O   |
| userPhone       | String | 사용자 핸드폰 번호                                                                                                                                    | O   |
| retTransferType | String | 요청 대상의 결과 전송 타입<br>- 개인정보 서버 수신 모드 : MOKResult                                                                                                | O   |
#### JSON : MOKAuthInfo(인증요청 정보)
```json
{
	"serviceType": "telcoAuth",
	"providerId": ${providerId},
	"reqAuthType": "PASS",
	"usageCode": ${usageCode},
	"userName": ${userName},
	"userPhone": ${userPhone},
	"retTransferType": "MOKResult"
}
```

> 위 JSON 데이터는 실제 사용 시 문자열(JSON string) 형태로 변환하여 사용해야 합니다.
---
## 휴대폰본인본인 + 성인인증

### SMS

| 이름                     | 타입     | 설명                                                                              | 필수  |
| ---------------------- | ------ | ------------------------------------------------------------------------------- | --- |
| serviceType            | String | 이용상품 코드<br>“telcoAuth-Adult" : 휴대폰본인확인 SMS 성인 인증 서비스                            | O   |
| providerId             | String | 서비스 제공 이동통신사 및 서비스<br>- SKT / SKTMVNO<br>- KT / KTMVNO<br>- LGU / LGUMVNO       | O   |
| reqAuthType            | String | 본인확인 인증Type 코드  (인증번호 전송 타입 또는 인증방법)<br>- SMS                                   | O   |
| usageCode              | String | 서비스 이용 코드<br>- 01016 : 민법<br>- 01026 : 청소년 보호법                                  | O   |
| username               | String | 사용자명                                                                            | O   |
| userPhone              | String | 사용자 핸드폰 번호                                                                      | O   |
| userBirthday           | String | 사용자 생년월일 (8자리) YYYYMMDD                                                         | O   |
| userRegistSingleNumber | String | 사용자 주민번호 뒤 자리 첫번째 숫자  <br>해당 파라미터가 사용되는 경우 userGender와 userNation값은 무시됩니다.      |     |
| userGender             | String | 사용자 성별<br>- 1 : 남자<br>- 2 : 여자                                                  | O   |
| userNation             | String | 사용자 내외국인 정보<br>- 0 : 내국인<br>- 1 : 외국인                                           | O   |
| sendMsg                | String | SMS 전송 시 사용할 80Byte 이내 메시지.  <br>- NULL 또는 속성이 없을 경우 기본메시지 전송                   |     |
| replyNumber            | String | SMS 전송 시 사용할 송신번호 입력- NULL 또는 속성이 없을 경우 서비스에 등록된 이용기관 전화번호 또는 휴대폰본인확인 콜센터 번호 입력 |     |
| retTransferType        | String | 요청 대상의 결과 전송 타입<br>- 개인정보 서버 수신 모드 : MOKResult                                  | O   |
#### JSON : MOKAuthInfo(인증요청 정보)

```json
{
	"serviceType": "telcoAuth-Adult",
	"providerId": ${providerId},
	"reqAuthType": "SMS",
	"usageCode": ${usageCode},
	"userName": ${userName},
	"userPhone": ${userPhone},
	"userBirthday": ${userBirthday},
	"userGender": ${userGender},
	"userNation": ${userNation},
	"retTransferType": "MOKResult"
}
```

> 위 JSON 데이터는 실제 사용 시 문자열(JSON string) 형태로 변환하여 사용해야 합니다.
---
## 휴대폰본인본인 + LMS

| 이름                     | 타입     | 설명                                                                                                                                            | 필수  |
| ---------------------- | ------ | --------------------------------------------------------------------------------------------------------------------------------------------- | --- |
| serviceType            | String | 이용상품 코드<br>- telcoAuth-LMS : 휴대폰본인확인 LMS 문자 안내 전송 서비스                                                                                         | O   |
| providerId             | String | 서비스 제공 이동통신사 및 서비스<br>- SKT / SKTMVNO<br>- KT / KTMVNO<br>- LGU / LGUMVNO                                                                     | O   |
| reqAuthType            | String | 본인확인 인증Type 코드, 인증번호 전송 타입 또는 인증방법<br>- LMS                                                                                                   | O   |
| usageCode              | String | 서비스 이용 코드<br>- 01001 : 회원가입<br>- 01002 : 정보변경  <br>- 01003 : ID찾기<br>- 01004 : 비밀번호찾기<br>- 01005 : 본인확인용<br>- 01007 : 상품구매/결제<br>- 01999 : 기타 | O   |
| username               | String | 사용자명                                                                                                                                          | O   |
| userPhone              | String | 사용자 핸드폰 번호                                                                                                                                    | O   |
| userBirthday           | String | 사용자 생년월일 (8자리) YYYYMMDD                                                                                                                       | O   |
| userRegistSingleNumber | String | 사용자 주민번호 뒤 자리 첫번째 숫자  <br>해당 파라미터가 사용되는 경우 userGender와 userNation값은 무시됩니다.                                                                    |     |
| userGender             | String | 사용자 성별<br>- 1 : 남자<br>- 2 : 여자                                                                                                                | O   |
| userNation             | String | 사용자 내외국인 정보<br>- 0 : 내국인<br>- 1 : 외국인                                                                                                         | O   |
| sendMsg                | String | LMS 전송 시 사용할 2000Byte 이내 메시지.  <br>NULL 또는 속성이 없을 경우 기본메시지 전송                                                                                 |     |
| replyNumber            | String | LMS 전송 시 사용할 송신번호 입력,  <br>NULL 또는 속성이 없을경우 서비스에 등록된 이용기관 전화번호 또는 휴대폰본인확인 콜센터 번호 입력                                                           |     |
| retTransferType        | String | 요청 대상의 결과 전송 타입-<br>개인정보 서버 수신 모드 : MOKResult                                                                                                 | O   |
#### JSON : MOKAuthInfo(인증요청 정보)
```json
{
	"serviceType": "telcoAuth-LMS",
	"providerId": ${providerId},
	"reqAuthType": "LMS",
	"usageCode": ${usageCode},
	"userName": ${userName},
	"userPhone": ${userPhone},
	"userBirthday": ${userBirthday},
	"userGender": ${userGender},
	"userNation": ${userNation},
	"retTransferType": "MOKResult"
}
```

> 위 JSON 데이터는 실제 사용 시 문자열(JSON string) 형태로 변환하여 사용해야 합니다.
---
## 휴대폰본인확인 + ARS (ARS 점유인증)

| 이름              | 타입         | 설명                                                                                                                                                                      | 필수  |
| --------------- | ---------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --- |
| serviceType     | String     | 이용상품 코드<br>- telcoAuth-ARSAuth : 휴대폰본인확인 + ARS인증서비스                                                                                                                     | O   |
| providerId      | String     | 서비스 제공 이동통신사 및 서비스<br>- SKT / SKTMVNO<br>- KT / KTMVNO<br>- LGU / LGUMVNO                                                                                               | O   |
| reqAuthType     | String     | 본인확인 인증Type 코드, 인증번호 전송 타입 또는 인증방법<br>- ARS                                                                                                                             | O   |
| arsCode         | String     | ARS인증을 사용하는 이용기관별로 등록된 ARS 코드 입력                                                                                                                                        | O   |
| usageCode       | String     | 서비스 이용 코드<br>- 01001 : 회원가입<br>- 01002 : 정보변경  <br>- 01003 : ID찾기<br>- 01004 : 비밀번호찾기<br>- 01005 : 본인확인용<br>- 01007 : 상품구매/결제<br>- 01999 : 기타                           | O   |
| username        | String     | 사용자명                                                                                                                                                                    | O   |
| userPhone       | String     | 사용자 핸드폰 번호                                                                                                                                                              | O   |
| userBirthday    | String     | 사용자 생년월일 (8자리) YYYYMMDD                                                                                                                                                 | O   |
| userGender      | String     | 사용자 성별<br>- 1 : 남자<br>- 2 : 여자                                                                                                                                          | O   |
| userNation      | String     | 사용자 내외국인 정보<br>- 0 : 내국인<br>- 1 : 외국인                                                                                                                                   | O   |
| replyNumber     | String     | SMS 전송 시 사용할 송신번호 입력<br>- NULL 또는 속성이 없을 경우 서비스에 등록된 이용기관 전화번호 또는 휴대폰본인확인 콜센터 번호 입력                                                                                     |     |
| retTransferType | String     | 요청 대상의 결과 전송 타입<br>- 개인정보 서버 수신 모드 : MOKResult                                                                                                                          | O   |
| extension       | JSONObject | ARS 점유인증 요청시 이용기관별 추가정보 전달처리에 이용 <br>추가정보 입력 extension/arsRequestMsg  <br>json<br>  "extension": {<br>    "arsRequestMsg": {<br>      "bankCode": "023"<br>    }<br>  } |     |
#### JSON : MOKAuthInfo(인증요청 정보)
```json
{
    "serviceType": "telcoAuth-ARSAuth",
    "providerId": ${providerId},
    "reqAuthType": "ARS",
    "arsCode" : ${arsCode},
    "usageCode": ${usageCode},
    "userName": ${userName},
    "userPhone": ${userPhone},
    "userBirthday": ${userBirthday},
    "userGender": ${userGender},
    "userNation": ${userNation},
    "retTransferType": "MOKResult",
    "extension": {
        "arsRequestMsg": {
            "bankCode": "023"
        }
    }
}
```

> 위 JSON 데이터는 실제 사용 시 문자열(JSON string) 형태로 변환하여 사용해야 합니다.
---
## SMS 점유인증

| 이름              | 타입     | 설명                                                                                                                                            | 필수  |
| --------------- | ------ | --------------------------------------------------------------------------------------------------------------------------------------------- | --- |
| serviceType     | String | 이용상품 코드<br>- SMSAuth : SMS 점유인증 문자 안내 전송 서비스                                                                                                  | O   |
| providerId      | String | 서비스 제공 이동통신사 및 서비스<br>- SKT / SKTMVNO<br>- KT / KTMVNO<br>- LGU / LGUMVNO                                                                     | O   |
| reqAuthType     | String | 본인확인 인증Type 코드, 인증번호 전송 타입 또는 인증방법<br>- SMS                                                                                                   | O   |
| usageCode       | String | 서비스 이용 코드<br>- 01001 : 회원가입<br>- 01002 : 정보변경  <br>- 01003 : ID찾기<br>- 01004 : 비밀번호찾기<br>- 01005 : 본인확인용<br>- 01007 : 상품구매/결제<br>- 01999 : 기타 | O   |
| username        | String | 사용자명                                                                                                                                          | O   |
| userPhone       | String | 사용자 핸드폰 번호                                                                                                                                    | O   |
| sendMsg         | String | SMS 전송 시 사용할 80Byte 이내 메시지.  <br>- NULL 또는 속성이 없을 경우 기본메시지 전송                                                                                 |     |
| replyNumber     | String | SMS 전송 시 사용할 송신번호 입력<br>- NULL 또는 속성이 없을 경우 서비스에 등록된 이용기관 전화번호 또는 휴대폰본인확인 콜센터 번호 입력                                                           |     |
| retTransferType | String | 요청 대상의 결과 전송 타입<br>- 개인정보 서버 수신 모드 : MOKResult                                                                                                | O   |
#### JSON : MOKAuthInfo(인증요청 정보)
```json
{
    "serviceType": "SMSAuth",
    "providerId": ${providerId},
    "reqAuthType": "SMS",
	"usageCode": ${usageCode},
    "userName": ${userName},
    "userPhone": ${userPhone},
    "retTransferType": "MOKResult"
}
```

> 위 JSON 데이터는 실제 사용 시 문자열(JSON string) 형태로 변환하여 사용해야 합니다.
---
# 암호화

## 본인확인-API 인증요청 정보(encryptMOKAuthInfo)

## 3️⃣인증 요청정보 암호화

#### Step 1. AES 암호화 키와 IV 생성과 인증 요청 정보 암호화
- **Step 1-1.** 인증 요청 정보를 암호화하기 위해 AES 암호화 키(key)와 초기화 벡터(iv)를 생성합니다. 

>[!summary] AES 암호화 키와 IV 생성
> - 키와 IV는 난수 생성기를 사용해 무작위로 생성된 바이트 배열
> - key는 32바이트 (AES 256bit 암호화용)  
> - iv는 16바이트 (AES CBC 모드에서 사용하는 IV)
> 
> 예시) `byte[] aesKey = new byte[32]` `byte[] iv = new byte[16];`

> [!warning] 하드코딩된 값은 보안상 절대 사용하면 안됩니다, 매번 요청마다 새로 생성해야 합니다.

- **Step 1-2.** 인증요청 정보를 AES 암호화 (AES/CBC/PKCS5Padding)합니다.
	1. AES 키 및 IV 준비  
	  - 생성한 AES 키(`aesKey`)와 IV(`iv`)를 사용해서 암호화에 필요한 객체 준비  
	2. AES 암호화 알고리즘 설정 
	  - `AES/CBC/PKCS5Padding` 방식으로 설정
	3. 인증 요청 본문 암호화
	  - 인증요청 본문 (예: `MOKAuthInfo` ) 을 UTF-8로 인코딩 하여 바이트 배열(byte[]) 형태로 변환하여 암호화
	4. Base64 인코딩 처리  
	  - 암호화된 데이터를 그대로 전송하기 어려우므로, Base64 인코딩하여 저장 (예: `encData`)
- **Step 1-3.** 해시값을 생성 (SHA-256) 합니다.

>[!summary] 해시값 생성 (SHA-256)
> - 암호화되기 전 인증 요청 본문 (예: `MOKAuthInfo` )  문자열을 SHA-256 해시로 처리
> - 해시 결과는 Base64로 인코딩하여 문자열(hash)로 저장
> - 이 해시값은 key + iv를 묶은 평문을 만들 때 사용

#### Step 2. AES 키(key)와 IV(iv)를 안전하게 전달하기 위한 추가 암호화

- **Step 2-1.** 공개키를 준비합니다.
>[!summary] RSA 공개키
> - 공개키는 X.509 포맷이며, Base64 디코딩 후 바이트 배열로 변환 
> - 공개키는 본인확인 거래요청정보(토큰) 요청 시 본인확인 서버로부터 응답받은 JSON의 `publicKey` 필드를 말한다.
> ```json
> {
>	"encryptMOKToken" : "[RBj8YiVJ5e8lOChfhE76+AJj … pikDZMbeegv9r79uVUcMdA==",
>	"publicKey" : "MIIBIjANBgkqhkiG … N+Ey0zPfswIDAQAB",
>	"resultCode" : "2000",
>	"resultMsg" : "success"
}

- **Step 2-2.** 암호화 방식을 설정합니다.
	1. RSA 암호화 방식 설정
		- `RSA with OAEP Padding`을 사용 
>[!summary]   RSA 암호화 알고리즘 패딩 구성
>- 해시 함수: SHA-256  
>- 마스킹 함수(MGF): MGF1 (SHA-256 기반)  
>- PSource: default 값 사용 (PSource.PSpecified.DEFAULT에 해당하는 값)  
>  (SHA-256, MGF1, MGF1ParameterSpec(“SHA-256”), PSource.PSpecified.DEFAULT)

>[!warning] 이 설정은 각 언어의 RSA 암호화 함수에서 패딩 옵션으로 명시되어야 하며,  OAEP 모드를 지원하지 않는 RSA 함수는 사용할 수 없습니다.

- **Step 2-3.** key + iv를 결합하여 `keyIv` 바이트 배열(byte[])을 생성합니다.
	1. key + iv 결합 (48바이트) 
		- AES 암호화에 사용된 key(32byte) 와 iv(16byte)를 붙여서 총 48바이트의 바이트 배열을 만듦
	2. 첫 번째 구간 (0 ~ 31 바이트)
		- 앞 32바이트에는 key(AES 암호화 키)값을 복사 
	3. 두 번째 구간 (32 ~ 47 바이트)
		- 뒤 16 바이트에는 iv(AES 암호화 IV)값을 복사
	4. Base64 인코딩 처리
- **Step 2-4.** 평문을 생성 (`keyIvBase64 + '|' + hash`) 합니다.
	1. 최종 평문(`encKey`) 생성
		- `keyIv` 바이트 배열을 Base64로 인코딩해서 문자열로 변환
		- 그 문자열과 `keyIv`의 SHA-256 해시 값을 `|` 기호로 이어 붙여 하나의 문자열로 만듦
- **Step 2-5.** 평문 데이터를 RSA 방식으로 암호화합니다.
	1. 평문 문자열 변환
		- Step 2-4에서 생성한 평문 문자열(`encKey`)을 UTF-8로 인코딩해서 바이트 배열로 변환
	2. RSA 암호화 방식 설정 및 암호화 진행
		- `RSA/ECB/OAEPPadding` 모드로 변환된 바이트 배열(byte[]) 암호화 진행
 - **Step 2-6.** 암호화된 데이터를 조합하여 최종 전송 데이터를 생성합니다.  
	1. RSA 암호화 결과 인코딩  
		- Step 2-5에서 생성된 RSA 암호화 결과를 Base64로 인코딩해서 문자열로 변환  
	2. 최종 데이터 조합  (encryptMOKAuthInfo)
		- 인코딩된 RSA 결과와 AES로 암호화한 인증 요청 데이터(`encData`)를 `'|'` 기호로 이어 붙여 최종 문자열 생성  
		- 형식: `암호화된 encKey | encData`

#### 샘플은 JAVA로 제공됩니다.
```java
import com.fasterxml.jackson.databind.ObjectMapper;  
  
import javax.crypto.Cipher;  
import javax.crypto.spec.IvParameterSpec;  
import javax.crypto.spec.OAEPParameterSpec;  
import javax.crypto.spec.PSource;  
import javax.crypto.spec.SecretKeySpec;  
import java.nio.charset.StandardCharsets;  
import java.security.KeyFactory;  
import java.security.MessageDigest;  
import java.security.PublicKey;  
import java.security.SecureRandom;  
import java.security.spec.MGF1ParameterSpec;  
import java.security.spec.X509EncodedKeySpec;  
import java.util.Base64;  
import java.util.HashMap;  
import java.util.Map;

public class MOKAuthInfoEncryption {  
    // 인증요청 정보 암호화 메서드
    public static String encryptMOKAuthInfo(String authInfo, String publicKeyBase64) throws Exception {
        // Step 1: AES 암호화 키와 IV 생성
        SecureRandom secureRandom = new SecureRandom();
        byte[] aesKey = new byte[32]; // 32바이트 AES 키
        byte[] iv = new byte[16];     // 16바이트 IV
        secureRandom.nextBytes(aesKey);
        secureRandom.nextBytes(iv);

        // Step 1-2: AES 암호화 (AES/CBC/PKCS5Padding)
        Cipher aesCipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
        SecretKeySpec secretKeySpec = new SecretKeySpec(aesKey, "AES");
        IvParameterSpec ivSpec = new IvParameterSpec(iv);
        aesCipher.init(Cipher.ENCRYPT_MODE, secretKeySpec, ivSpec);

        byte[] encryptedData = aesCipher.doFinal(authInfo.getBytes(StandardCharsets.UTF_8));
        String encData = Base64.getEncoder().encodeToString(encryptedData);

        // Step 1-3: SHA-256 해시 생성
        MessageDigest sha256 = MessageDigest.getInstance("SHA-256");
        byte[] hashBytes = sha256.digest(authInfo.getBytes(StandardCharsets.UTF_8));
        String hash = Base64.getEncoder().encodeToString(hashBytes);

        // Step 2-3: key + iv 결합 (48바이트)
        byte[] keyIv = new byte[48];
        System.arraycopy(aesKey, 0, keyIv, 0, 32); // 앞 32바이트는 AES 키
        System.arraycopy(iv, 0, keyIv, 32, 16);     // 뒤 16바이트는 IV

        // Step 2-4: 평문 생성 (keyIvBase64 + '|' + hash)
        String keyIvBase64 = Base64.getEncoder().encodeToString(keyIv);
        String encKey = keyIvBase64 + "|" + hash;

        // Step 2-1: RSA 공개키 준비
        byte[] publicKeyBytes = Base64.getDecoder().decode(publicKeyBase64);
        X509EncodedKeySpec keySpec = new X509EncodedKeySpec(publicKeyBytes);
        KeyFactory keyFactory = KeyFactory.getInstance("RSA");
        PublicKey publicKey = keyFactory.generatePublic(keySpec);

        // Step 2-2 & 2-5: RSA 암호화 (RSA/ECB/OAEPPadding)
        OAEPParameterSpec oaepParams = new OAEPParameterSpec(
            "SHA-256", "MGF1", MGF1ParameterSpec.SHA256, PSource.PSpecified.DEFAULT
        );
        Cipher rsaCipher = Cipher.getInstance("RSA/ECB/OAEPWithSHA-256AndMGF1Padding");
        rsaCipher.init(Cipher.ENCRYPT_MODE, publicKey, oaepParams);

        byte[] encryptedKeyIv = rsaCipher.doFinal(encKey.getBytes(StandardCharsets.UTF_8));
        String encryptedKeyIvBase64 = Base64.getEncoder().encodeToString(encryptedKeyIv);

        // Step 2-6: 최종 데이터 조합 (encryptMOKAuthInfo)
        return encryptedKeyIvBase64 + "|" + encData;
    }
	public static void main(String[] args) throws Exception {
		Map<String, Object> data = new HashMap<>();
		data.put("serviceType", "serviceType");  
		data.put("providerId", "providerId");  
		data.put("reqAuthType", "reqAuthType");  
		data.put("usageCode", "usageCode");  
		data.put("userName", "userName");  
		data.put("userPhone", "userPhone");  
		data.put("userBirthday", "userBirthday");  
		data.put("userGender", "userGender");  
		data.put("userNation", "userNation");  
		data.put("sendMsg", "sendMsg");  
		data.put("replyNumber", "replyNumber");  
		data.put("retTransferType", "retTransferType");
		ObjectMapper mapper = new ObjectMapper();  
		// 인증 요청 데이터  
		String target = mapper.writeValueAsString(data);
		// 서버에서 받은 공개키
		String publicKeyBase64 = "your_publicKey";
		String encryptedResult = encryptMOKAuthInfo(target, publicKeyBase64);  
		System.out.println("Encrypted Result: " + encryptedResult);
	}
}
```